(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{7909:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agendar-updated",function(){return o(2197)}])},2197:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return Agendar}});var l=o(5893),s=o(7294),n=o(7185),r=o(3120),t=o(6398),d=o(8717);o(8281);var i=o(3454);function Agendar(){let[e,a]=(0,s.useState)(1),[o,c]=(0,s.useState)(null),[u,x]=(0,s.useState)([]),[b,m]=(0,s.useState)(""),[h,g]=(0,s.useState)(""),[p,f]=(0,s.useState)(""),[j,v]=(0,s.useState)([]),[N,y]=(0,s.useState)(null),[w,S]=(0,s.useState)(""),[k,_]=(0,s.useState)(!1),handleSubmit=async()=>{try{var e,l;if(_(!0),!o||!u.length||!b||!p){alert("⚠️ Por favor, preencha todos os campos obrigat\xf3rios"),_(!1);return}let s={userId:1,serviceId:(null===(e=u[0])||void 0===e?void 0:e.id)||1,date:o,time:"10:00",address:b,phone:p,price:calculateTotal(),notes:w},n=localStorage.getItem("token")||"demo-token",r=i.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",t=await fetch("".concat(r,"/api/bookings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(s)});if(!t.ok){let e=await t.json();throw Error(e.error||"Falha ao agendar")}let d=await t.json();console.log("✅ Agendamento criado:",d),alert("✅ Agendamento realizado com sucesso!\nID: ".concat((null===(l=d.booking)||void 0===l?void 0:l.id)||"N/A")),c(null),x([]),m(""),f(""),g(""),S(""),a(1)}catch(e){console.error("❌ Erro ao processar agendamento:",e),alert("❌ Erro: ".concat(e.message||"Falha ao agendar. Tente novamente."))}finally{_(!1)}},calculateTotal=()=>u.reduce((e,a)=>e+(a.price||0),0);return(0,l.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)("main",{className:"flex-grow max-w-4xl mx-auto w-full px-4 py-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Agendar Servi\xe7o de Limpeza"}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4].map(a=>(0,l.jsx)("div",{className:"flex-1 h-2 mx-1 rounded transition ".concat(a<=e?"bg-blue-600":"bg-gray-300")},a))}),(0,l.jsxs)("p",{className:"text-center text-gray-600 font-semibold",children:["Passo ",e," de 4"]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[1===e&&(0,l.jsx)(t.Z,{onDateSelected:c}),2===e&&(0,l.jsx)(d.Z,{onServiceSelected:x}),3===e&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Localiza\xe7\xe3o e Detalhes"}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-semibold mb-2",children:"Telefone *"}),(0,l.jsx)("input",{type:"tel",value:p,onChange:e=>f(e.target.value),placeholder:"(11) 9999-9999",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-semibold mb-2",children:"Endere\xe7o Completo *"}),(0,l.jsx)("input",{type:"text",value:b,onChange:e=>m(e.target.value),placeholder:"Rua, n\xfamero, complemento, bairro, cidade",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-semibold mb-2",children:"CEP"}),(0,l.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"00000-000",className:"w-48 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-semibold mb-2",children:"Notas Adicionais"}),(0,l.jsx)("textarea",{value:w,onChange:e=>S(e.target.value),placeholder:"Informa\xe7\xf5es adicionais sobre o servi\xe7o...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600",rows:"4"})]})]})]}),4===e&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Resumo do Agendamento"}),(0,l.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg space-y-3",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Data:"})," ",o]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Servi\xe7o:"})," ",u.map(e=>e.name).join(", ")]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Endere\xe7o:"})," ",b]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Telefone:"})," ",p]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Total:"})," R$ ",calculateTotal().toFixed(2)]})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-between gap-4 mb-8",children:[(0,l.jsx)("button",{onClick:()=>{e>1&&a(e-1)},disabled:1===e,className:"px-6 py-3 border border-gray-300 rounded-lg font-semibold disabled:opacity-50",children:"Voltar"}),e<4?(0,l.jsx)("button",{onClick:()=>{e<4&&a(e+1)},className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Pr\xf3ximo"}):(0,l.jsx)("button",{onClick:handleSubmit,disabled:k,className:"px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50",children:k?"⏳ Agendando...":"✅ Confirmar Agendamento"})]})]}),(0,l.jsx)(r.Z,{})]})}}},function(e){e.O(0,[664,874,774,888,179],function(){return e(e.s=7909)}),_N_E=e.O()}]);